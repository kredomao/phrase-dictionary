# 翻訳フレーズ辞書アプリ（共有版）

HeyGenの翻訳を効率化するための辞書アプリです。英語フレーズと日本語訳を保存・検索して、ワンクリックで採用できます。

## ✨ 主な機能

- 🔍 **曖昧検索**: 完全一致でなくても類似フレーズを自動検出
- 👥 **ログイン機能**: パスワード認証で安全に共有
- 📊 **操作ログ**: 誰が何をしたか記録
- 💾 **CSV入出力**: 簡単にバックアップと復元
- 🎯 **使用頻度トラッキング**: よく使う訳を優先表示

## セットアップ手順

### 1. 仮想環境の作成（推奨）

```bash
python -m venv .venv
```

### 2. 仮想環境の有効化

**Windows の場合:**
```bash
.venv\Scripts\activate
```

**macOS/Linux の場合:**
```bash
source .venv/bin/activate
```

### 3. パッケージのインストール

```bash
pip install -r requirements.txt
```

## 使い方

### アプリの起動

```bash
streamlit run app.py
```

ブラウザが自動で開き、`http://localhost:8501` でアプリにアクセスできます。

### 基本的な操作フロー

1. **データの準備**（左側）
   - 既存の `phrases.csv` をアップロードする、または
   - 手動でフレーズを1つずつ登録する

2. **検索と候補提示**（右側）
   - 英語フレーズを入力すると類似候補が表示されます
   - 「採用」ボタンで訳を編集欄に反映
   - 必要に応じて編集して「この訳を辞書に保存」

3. **エクスポート**
   - 「辞書をCSVでエクスポート」ボタンで辞書をバックアップ

## ファイル構成

- `app.py` - メインアプリケーション
- `requirements.txt` - 必要なPythonパッケージ
- `phrases.csv` - サンプルの翻訳データ（アップロード用）
- `phrases.db` - SQLiteデータベース（自動生成）

## CSV フォーマット

CSV ファイルは以下の列を含む必要があります：

- `source` - 原文（英語）【必須】
- `target` - 訳文（日本語）【必須】
- `context` - コンテキスト情報（任意）
- `tags` - タグ（カンマ区切り、任意）

## HeyGenのSRTから辞書を自動生成する方法

### 1. SRTファイルをダウンロード

HeyGenから以下の2つのファイルをダウンロードします：
- **Download Original Transcript SRT** → `english.srt` にリネーム
- **Download Translation SRT** → `japanese.srt` にリネーム

両方を作業フォルダ（このREADMEと同じ場所）に配置してください。

### 2. SRT突合スクリプトを実行

```bash
python align_srt_to_csv.py
```

これで `pairs.csv` が自動生成されます。このCSVには以下の列が含まれます：
- `source` - 英語原文
- `target` - 日本語訳
- `eng_start`, `eng_end` - 英語字幕のタイミング
- `jpn_start`, `jpn_end` - 日本語字幕のタイミング

### 3. 生成されたCSVを辞書に取り込む

Streamlitアプリを起動して、左側の「既存の翻訳CSVをアップロード」から `pairs.csv` をアップロードします。

```bash
streamlit run app.py
```

これで、HeyGenで翻訳したフレーズがすべて辞書として使えるようになります！

### 注意点

- **タイミングのずれ**: 英語と日本語の字幕タイミングがずれている場合、マッチしないことがあります
- **文字コード**: SRTファイルはUTF-8で保存されている必要があります
- **重複処理**: 同じ英語フレーズに複数の日本語訳がある場合は、手動で整理することをおすすめします

## 今後の拡張案

1. ~~SRT字幕ファイルの読み込み・一括処理~~ ✅ 実装済み
2. 類似度の閾値設定と自動採用機能
3. HeyGen API連携
4. タイムライン表示の改善
5. SRT内の重複フレーズの自動統合

## トラブルシューティング

エラーが発生した場合は、ターミナルに表示されるエラーメッセージ全文を確認してください。

よくある問題：
- Pythonのバージョンが3.9未満の場合は、3.9以上にアップグレードしてください
- パッケージのインストールに失敗する場合は、pip を最新版にアップデート: `python -m pip install --upgrade pip`

